<!-- AUTO-GENERATED by tools/docgen.ps1 - do not edit manually -->
<!-- Regenerate with: powershell -ExecutionPolicy Bypass -File tools/docgen.ps1 -->

# Hexagon API Reference

Complete API reference for the Hexagon roleplay framework for s&box (Source 2, C#).

## Table of Contents

- [Hexagon.Core](#hexagoncore)
- [Hexagon.Characters](#hexagoncharacters)
- [Hexagon.Factions](#hexagonfactions)
- [Hexagon.Items](#hexagonitems)
- [Hexagon.Items.Bases](#hexagonitemsbases)
- [Hexagon.Inventory](#hexagoninventory)
- [Hexagon.Chat](#hexagonchat)
- [Hexagon.Commands](#hexagoncommands)
- [Hexagon.Permissions](#hexagonpermissions)
- [Hexagon.Currency](#hexagoncurrency)
- [Hexagon.Attributes](#hexagonattributes)
- [Hexagon.Config](#hexagonconfig)
- [Hexagon.Logging](#hexagonlogging)
- [Hexagon.Doors](#hexagondoors)
- [Hexagon.Storage](#hexagonstorage)
- [Hexagon.Vendors](#hexagonvendors)
- [Hexagon.UI](#hexagonui)
- [Hexagon.Persistence](#hexagonpersistence)
- [Listener Interfaces](#listener-interfaces)

---

## Hexagon.Core

### HexagonFramework (sealed) : Component

The core bootstrap component for the Hexagon roleplay framework. Attach this to a persistent GameObject in your scene to initialize all systems.

```csharp
static HexagonFramework Instance { get; set; }
static bool IsInitialized { get; set; }
```

| Member | Description |
|--------|-------------|
| `Instance` |  |
| `IsInitialized` | Whether the framework has finished initialization. |

### HexEvents (static)

Central event system for Hexagon. Provides two mechanisms: 1. Interface-based: Components implement listener interfaces and are auto-discovered via Scene. 2. Static events: Non-Component code subscribes to Action delegates.

```csharp
static void Fire<T>( Action<T> action )
static bool CanAll<T>( Func<T, bool> check )
static T Reduce<TListener, T>( T initial, Func<TListener, T, T> reducer )
```

| Member | Description |
|--------|-------------|
| `Fire` | Fires an event to all Components in the scene that implement interface T. |
| `CanAll` | Fires a Can-style permission hook. All listeners must return true for the action to proceed. If any listener returns false, the action is blocked. |
| `Reduce` | Fires a hook that collects a value, passing it through each listener in sequence. Each listener can modify the value before passing it to the next. |

### IHexPlugin (interface)

Interface for Hexagon plugins. Implement this alongside [HexPlugin] attribute to create a plugin that the framework auto-discovers and loads.

```csharp
void OnPluginLoaded()
void OnPluginUnloaded()
```

| Member | Description |
|--------|-------------|
| `OnPluginLoaded` | Called when the plugin is loaded during framework initialization. Register your systems (items, factions, commands, etc.) here. |
| `OnPluginUnloaded` | Called when the plugin is unloaded during framework shutdown. Clean up any resources here. |

### HexPluginAttribute : Attribute

Marks a class as a Hexagon plugin for auto-discovery. The class must also implement IHexPlugin.

```csharp
string Name { get; set; }
string Description { get; set; }
string Author { get; set; }
string Version { get; set; }
int Priority { get; set; }
```

### PluginManager (static)

Discovers and manages Hexagon plugins. Scans all loaded assemblies for classes marked with [HexPlugin] that implement IHexPlugin.

```csharp
static IReadOnlyList<PluginEntry> Plugins
static IHexPlugin Get( string name )
```

| Member | Description |
|--------|-------------|
| `Plugins` | All currently loaded plugins. |
| `Get` | Get a loaded plugin by name. |

### PluginEntry

Holds metadata and instance reference for a loaded plugin.

```csharp
string Name { get; set; }
string Description { get; set; }
string Author { get; set; }
string Version { get; set; }
int Priority { get; set; }
TypeDescription Type { get; set; }
IHexPlugin Instance { get; set; }
```

---

## Hexagon.Characters

### CharacterManager (static)

Manages character CRUD operations, auto-save, and CharVar metadata discovery. Initialized by HexagonFramework on startup.

```csharp
static IReadOnlyDictionary<string, CharVarInfo> CharVars
static CharVarInfo GetCharVarInfo( string name )
static IEnumerable<CharVarInfo> GetPublicCharVars()
static IEnumerable<CharVarInfo> GetLocalCharVars()
static HexCharacter CreateCharacter( HexPlayerComponent player, HexCharacterData data )
static bool LoadCharacter( HexPlayerComponent player, string characterId )
static void UnloadCharacter( HexPlayerComponent player )
static bool DeleteCharacter( HexPlayerComponent player, string characterId )
static List<HexCharacterData> GetCharacterList( ulong steamId )
static HexCharacter GetActiveCharacter( string characterId )
static IReadOnlyDictionary<string, HexCharacter> GetActiveCharacters()
static string ValidateCharacterData( HexCharacterData data )
static void SaveAll()
static HexCharacterData CreateDefaultData()
```

| Member | Description |
|--------|-------------|
| `CharVars` | All discovered CharVar metadata. |
| `GetCharVarInfo` | Get CharVar metadata by property name. |
| `GetPublicCharVars` | Get all CharVars that are public (not Local, not NoNetworking). |
| `GetLocalCharVars` | Get all CharVars that are Local (owner-only networking). |
| `CreateCharacter` | Create a new character for a player. |
| `LoadCharacter` | Load a character for a player by character ID. |
| `UnloadCharacter` | Unload the active character from a player (save + disconnect). |
| `DeleteCharacter` | Delete a character permanently. |
| `GetCharacterList` | Get the character list for a player by Steam ID. |
| `GetActiveCharacter` | Get an active character by ID. |
| `GetActiveCharacters` | Get all active characters. |
| `ValidateCharacterData` | Validate character data against CharVar constraints. Returns null if valid, or an error message string if invalid. |
| `SaveAll` | Save all active characters that have dirty data. |
| `CreateDefaultData` | Create an instance of the schema's character data type with defaults applied. |

### CharVarAttribute : Attribute

Marks a property on a HexCharacterData subclass as a character variable. The framework handles persistence, networking, and validation automatically. Usage: [CharVar(Default = "John Doe")] public string Name { get; set; } [CharVar(Local = true)] public int Money { get; set; }  // Owner-only [CharVar(NoNetworking = true)] public Dictionary&lt;string, object&gt; ServerData { get; set; }

```csharp
object Default { get; set; }
bool Local { get; set; }
bool NoNetworking { get; set; }
int MinLength { get; set; }
int MaxLength { get; set; }
bool ReadOnly { get; set; }
int Order { get; set; }
bool ShowInCreation { get; set; }
```

| Member | Description |
|--------|-------------|
| `Default` | Default value for this variable when creating a new character. |
| `Local` | If true, this variable is only networked to the owning player (not broadcast). Use for private data like money, flags, attributes. |
| `NoNetworking` | If true, this variable is never networked. Server-only data. |
| `MinLength` | Minimum string length for validation. Only applies to string properties. |
| `MaxLength` | Maximum string length for validation. Only applies to string properties. |
| `ReadOnly` | If true, this variable cannot be modified after character creation. |
| `Order` | Display order in character creation UI. Lower numbers appear first. |
| `ShowInCreation` | If true, this variable is shown in character creation UI. |

### HexCharacter

Runtime wrapper around a character's persistent data. Provides gameplay methods, dirty tracking for efficient saves, and networking helpers. Created when a player loads a character. One active HexCharacter per player at a time.

```csharp
HexCharacterData Data { get; }
HexPlayerComponent Player { get; set; }
bool IsDirty { get; set; }
string Id
ulong SteamId
string Faction
string Class
bool HasFlag( char flag )
bool HasFlags( string flags )
void GiveFlag( char flag )
void TakeFlag( char flag )
T GetData<T>( string key, T defaultValue )
void SetData( string key, object value )
T GetVar<T>( string name, T defaultValue )
void SetVar( string name, object value )
void SetFaction( string factionId )
void SetClass( string classId )
void Ban( TimeSpan? duration )
void Unban()
HashSet<string> GetRecognizedIds()
void AddRecognized( string characterId )
void MarkDirty( string fieldName )
void Save()
IReadOnlySet<string> GetDirtyFields()
```

| Member | Description |
|--------|-------------|
| `Data` | The underlying persistent data. |
| `Player` | The player component this character is attached to. Null if character is not active. |
| `IsDirty` | Whether any data has changed since last save. |
| `Id` |  |
| `SteamId` |  |
| `Faction` |  |
| `Class` |  |
| `HasFlag` | Check if this character has a specific flag. |
| `HasFlags` | Check if this character has all specified flags. |
| `GiveFlag` | Grant a flag to this character. |
| `TakeFlag` | Remove a flag from this character. |
| `GetData` | Get a value from the character's generic data store. |
| `SetData` | Set a value in the character's generic data store. |
| `GetVar` | Get a character variable value by name using reflection. Prefer using the typed property on your HexCharacterData subclass directly. |
| `SetVar` | Set a character variable value by name using reflection. Prefer using the typed property on your HexCharacterData subclass directly, then calling MarkDirty(). |
| `SetFaction` | Set this character's faction. |
| `SetClass` | Set this character's class within their current faction. |
| `Ban` | Ban this character. Pass null duration for permanent ban. |
| `Unban` | Unban this character. |
| `GetRecognizedIds` | Get the set of character IDs this character recognizes. |
| `AddRecognized` | Add a character ID to this character's recognition list. |
| `MarkDirty` | Mark a field as dirty (changed since last save). Call this after modifying character data properties directly. |
| `Save` | Save this character to the database if dirty. |
| `GetDirtyFields` | Get the list of fields that have changed since last save. |

### HexCharacterData (abstract)

Base class for character data. Schema devs extend this with [CharVar] properties to define their character fields. Usage: public class MyCharacter : HexCharacterData { [CharVar(Default = "John Doe", MinLength = 3, MaxLength = 64, Order = 1)] public string Name { get; set; } [CharVar(Default = "A mysterious stranger.", MinLength = 16, MaxLength = 512, Order = 2)] public string Description { get; set; } [CharVar(Order = 3)] public string Model { get; set; } [CharVar(Local = true)] public int Money { get; set; } } The framework auto-discovers the concrete subclass at startup and uses it for all character creation, persistence, and networking.

```csharp
string Id { get; set; }
ulong SteamId { get; set; }
int Slot { get; set; }
string Faction { get; set; }
string Class { get; set; }
string Flags { get; set; }
Dictionary<string, object> Data { get; set; }
DateTime CreatedAt { get; set; }
DateTime LastPlayedAt { get; set; }
bool IsBanned { get; set; }
DateTime? BanExpiry { get; set; }
```

| Member | Description |
|--------|-------------|
| `Id` | Unique character ID (generated by the framework). |
| `SteamId` | Steam ID of the player who owns this character. |
| `Slot` | Character slot index (0-based) for this player. |
| `Faction` | The faction this character belongs to (references FactionDefinition name). |
| `Class` | The class within the faction (references ClassDefinition name). Empty if no class. |
| `Flags` | Character flags (permission characters, e.g. "pet" for physgun/entities/tools). |
| `Data` | Generic data store for plugin/schema-specific persistent data. |
| `CreatedAt` | When this character was created. |
| `LastPlayedAt` | When this character was last played. |
| `IsBanned` | Whether this character is currently banned. |
| `BanExpiry` | When the ban expires (null = permanent). |

### CharVarInfo

Metadata about a character variable, discovered via s&box TypeLibrary at startup.

```csharp
string Name { get; set; }
Type PropertyType { get; set; }
CharVarAttribute Attribute { get; set; }
PropertyDescription Property { get; set; }
object GetValue( HexCharacterData data )
void SetValue( HexCharacterData data, object value )
```

### HexGameManager (sealed) : Component, Component.INetworkListener

Handles player connections and spawning. Attach this to a GameObject in your scene alongside HexagonFramework. When a player connects: 1. Spawns the PlayerPrefab (or a default first-person player if no prefab is assigned) 2. Loads their character list 3. Fires IPlayerConnectedListener 4. Auto-loads their last character (or sends character list to client) When no PlayerPrefab is set, the default player includes PlayerController (movement, camera, interaction), a citizen model with Dresser, configured for first-person RP.

```csharp
[Property] GameObject PlayerPrefab { get; set; }
[Property] Vector3 SpawnPosition { get; set; }
readonly Dictionary<ulong, HexPlayerComponent> Players
static HexPlayerComponent GetPlayer( ulong steamId )
static HexPlayerComponent GetPlayer( Connection connection )
void OnActive( Connection connection )
void OnDisconnected( Connection connection )
```

| Member | Description |
|--------|-------------|
| `PlayerPrefab` | Optional prefab to spawn for each connecting player. If null, a default first-person player is created with PlayerController, citizen model, and Dresser. If set, must have a HexPlayerComponent (one will be added automatically if missing). |
| `SpawnPosition` | World position to spawn players at. Override via IPlayerSpawnListener. |
| `Players` | All currently connected players. |
| `GetPlayer` | Get a player component by Steam ID. |
| `GetPlayer` | Get a player component by Connection. |
| `OnActive` |  |
| `OnDisconnected` |  |

### HexModelHandler (sealed) : Component, ICharacterLoadedListener

Listens for character load events and applies character model/speeds to the player. Added to the HexagonFramework GameObject during initialization.

```csharp
void OnCharacterLoaded( HexPlayerComponent player, HexCharacter character )
```

| Member | Description |
|--------|-------------|
| `OnCharacterLoaded` | When a character loads, apply their model and speed settings. |

### CharacterListEntry

Lightweight DTO for character list sent to clients.

```csharp
string Id { get; set; }
string Name { get; set; }
string Description { get; set; }
string Faction { get; set; }
string Class { get; set; }
DateTime LastPlayed { get; set; }
```

### HexPlayerComponent (sealed) : Component

Component attached to each player's GameObject. Holds the networked character data that other players need to see, plus a server-side reference to the full HexCharacter. Public data ([Sync]): visible to all players (name, model, faction). Private data: synced only to the owner via RPC when it changes.

```csharp
[Sync] ulong SteamId { get; set; }
[Sync] string DisplayName { get; set; }
[Sync] string CharacterName { get; set; }
[Sync] string CharacterModel { get; set; }
[Sync] string CharacterDescription { get; set; }
[Sync] string FactionId { get; set; }
[Sync] string ClassId { get; set; }
[Sync] string CharacterId { get; set; }
[Sync] bool HasActiveCharacter { get; set; }
[Sync] bool IsDead { get; set; }
HexCharacter Character { get; set; }
Connection Connection { get; set; }
List<CharacterListEntry> ClientCharacterList { get; set; }
event Action OnCharacterListReceived
event Action<bool, string
float ActionStartTime { get; set; }
float ActionEndTime { get; set; }
string ActionText { get; set; }
event Action OnActionBarChanged
[Rpc.Host] void RequestCharacterList()
[Rpc.Host] void RequestLoadCharacter( string characterId )
[Rpc.Host] void RequestCreateCharacter( string json )
[Rpc.Host] void RequestDeleteCharacter( string characterId )
T GetPrivateVar<T>( string name, T defaultValue )
bool DoesRecognizeLocal( HexPlayerComponent target )
[Rpc.Host] void RequestIntroduce( int level )
```

| Member | Description |
|--------|-------------|
| `SteamId` |  |
| `DisplayName` |  |
| `CharacterName` |  |
| `CharacterModel` |  |
| `CharacterDescription` |  |
| `FactionId` |  |
| `ClassId` |  |
| `CharacterId` |  |
| `HasActiveCharacter` |  |
| `IsDead` |  |
| `Character` | The active character for this player. Only valid on the server. |
| `Connection` | The network connection for this player. |
| `ClientCharacterList` | Client-side character list received from the server. |
| `OnCharacterListReceived` | Fired on the client when the character list is received from the server. |
| `string` | Fired on the client when a character creation result is received. |
| `ActionStartTime` | Client-side: start time of the current action bar. |
| `ActionEndTime` | Client-side: end time of the current action bar. |
| `ActionText` | Client-side: text label for the current action bar. |
| `OnActionBarChanged` | Client-side: fired when action bar state changes. |
| `RequestCharacterList` | Client requests their character list from the server. |
| `RequestLoadCharacter` | Client requests to load a specific character. |
| `RequestCreateCharacter` | Client requests to create a new character from JSON data. |
| `RequestDeleteCharacter` | Client requests to delete a character. |
| `GetPrivateVar` | Client-side: get a private CharVar value that was synced from the server. |
| `DoesRecognizeLocal` | Client-side: check if this player recognizes a target player. |
| `RequestIntroduce` | Client requests to introduce themselves. Level: 0=look-at, 1=whisper, 2=talk, 3=yell. |

### HexPlayerSetup (static)

Static helper that builds a default player GameObject when no custom PlayerPrefab is assigned. Adds PlayerController (movement, camera, interaction), citizen model, and Dresser.

```csharp
static void BuildDefaultPlayer( GameObject playerGo )
static void ApplyCharacterToPlayer( HexPlayerComponent player, HexCharacter character )
```

| Member | Description |
|--------|-------------|
| `BuildDefaultPlayer` | Configure a bare GameObject as a fully functional first-person player. Adds PlayerController, SkinnedModelRenderer (citizen), and Dresser. |
| `ApplyCharacterToPlayer` | Apply character-specific data to an existing player (model, speeds). Called when a character loads or changes. |

### RecognitionManager (static)

Manages the recognizable names system. Characters are "Unknown" to others until formally introduced. Recognition is one-way and persists across sessions. Factions with IsGloballyRecognized are always known (e.g., police uniforms).

```csharp
static bool DoesRecognize( HexCharacter observer, HexCharacter target )
static bool Recognize( HexCharacter observer, string targetCharacterId )
static int IntroduceToRange( HexPlayerComponent player, float range )
static bool IntroduceToTarget( HexPlayerComponent player, HexPlayerComponent target )
static string GetDisplayName( HexPlayerComponent observer, HexPlayerComponent target )
static string GetDisplayNameForChat( HexPlayerComponent observer, HexPlayerComponent target )
static string FormatForListener( HexPlayerComponent observer, HexPlayerComponent speaker, string formatted )
```

| Member | Description |
|--------|-------------|
| `DoesRecognize` | Server-side: check if observer recognizes target. |
| `Recognize` | Server-side: add target to observer's recognition list. Returns true if newly recognized, false if already known. |
| `IntroduceToRange` | Server-side: introduce a character to all players within range. Returns the number of players who newly recognized the introducer. |
| `IntroduceToTarget` | Server-side: introduce to a specific player. Returns true if the target newly recognized the introducer. |
| `GetDisplayName` | Server-side: get the display name for a target as seen by an observer. Returns "Unknown" if not recognized. |
| `GetDisplayNameForChat` | Server-side: get a chat-friendly display name with truncated description for unknowns. |
| `FormatForListener` | Server-side: format a pre-formatted message replacing the speaker's real name with the recognition-aware name for a specific listener. |

---

## Hexagon.Factions

### ClassDefinition : GameResource

Defines a class (sub-role) within a faction. Create .class files in your schema's Assets folder via the s&box editor. Example: "Civil Protection Officer", "Medic", "Engineer", etc.

```csharp
[Property] string UniqueId { get; set; }
[Property] string Name { get; set; }
string Description { get; set; }
[Property] string FactionId { get; set; }
[Property] Model ClassModel { get; set; }
[Property] int MaxPlayers { get; set; }
[Property] int Order { get; set; }
[Property] List<LoadoutEntry> Loadout { get; set; }
[Property] LoadoutMode LoadoutMode { get; set; }
```

| Member | Description |
|--------|-------------|
| `UniqueId` | Unique identifier for this class. |
| `Name` | Display name of the class. |
| `Description` | Description of this class. |
| `FactionId` | The faction this class belongs to (reference the FactionDefinition UniqueId). |
| `ClassModel` | Override model when this class is active. Empty = use faction default. |
| `MaxPlayers` | Maximum active players in this class (0 = unlimited). |
| `Order` | Sort order within the faction. Lower = appears first. |
| `Loadout` | Items to grant when a character selects this class. |
| `LoadoutMode` | When to apply the loadout: OnCreate (once) or OnLoad (every time the character loads). |

### LoadoutEntry

A single item entry in a class loadout.

```csharp
[Property] string ItemDefinitionId { get; set; }
[Property] int Count { get; set; }
```

| Member | Description |
|--------|-------------|
| `ItemDefinitionId` | The UniqueId of the ItemDefinition to grant. |
| `Count` | How many of this item to grant. |

### LoadoutMode (enum)

Controls when a class loadout is applied to characters.

### FactionDefinition : GameResource

Defines a faction that characters can belong to. Create .faction files in your schema's Assets folder via the s&box editor. Example: Citizens faction, Combine faction, Rebels faction, etc.

```csharp
[Property] string UniqueId { get; set; }
[Property] string Name { get; set; }
string Description { get; set; }
[Property] Color Color { get; set; }
[Property] List<Model> Models { get; set; }
[Property] bool IsDefault { get; set; }
[Property] int MaxPlayers { get; set; }
[Property] int Order { get; set; }
[Property] int StartingMoney { get; set; }
[Property] bool IsGloballyRecognized { get; set; }
```

| Member | Description |
|--------|-------------|
| `UniqueId` | Unique identifier for this faction. Used in code and persistence. |
| `Name` | Display name of the faction. |
| `Description` | Description shown in character creation. |
| `Color` | Faction color used in chat, scoreboard, etc. |
| `Models` | Models available to characters in this faction. |
| `IsDefault` | If true, players can create characters in this faction without a whitelist. |
| `MaxPlayers` | Maximum active players in this faction (0 = unlimited). |
| `Order` | Sort order in character creation UI. Lower = appears first. |
| `StartingMoney` | Starting money for characters created in this faction. If -1, uses the global currency.startingAmount config. |
| `IsGloballyRecognized` | If true, members of this faction are always recognized by everyone. Useful for factions with distinctive uniforms (e.g., police, military). |

### FactionManager (static)

Manages faction and class definitions. Factions auto-register when their GameResource assets are loaded by s&box.

```csharp
static IReadOnlyDictionary<string, FactionDefinition> Factions
static IReadOnlyDictionary<string, ClassDefinition> Classes
static void Register( FactionDefinition faction )
static void RegisterClass( ClassDefinition classDef )
static FactionDefinition GetFaction( string uniqueId )
static ClassDefinition GetClass( string uniqueId )
static List<ClassDefinition> GetClassesForFaction( string factionId )
static List<FactionDefinition> GetDefaultFactions()
static List<FactionDefinition> GetAllFactions()
static int GetFactionPlayerCount( string factionId )
static bool CanJoinFaction( string factionId )
static int GetClassPlayerCount( string classId )
static bool CanJoinClass( string classId )
```

| Member | Description |
|--------|-------------|
| `Factions` | All registered factions. |
| `Classes` | All registered classes. |
| `Register` | Register a faction definition. Called automatically by FactionDefinition.PostLoad(). |
| `RegisterClass` | Register a class definition. Called automatically by ClassDefinition.PostLoad(). |
| `GetFaction` | Get a faction by its unique ID. |
| `GetClass` | Get a class by its unique ID. |
| `GetClassesForFaction` | Get all classes belonging to a faction. |
| `GetDefaultFactions` | Get all factions available for character creation (IsDefault = true). |
| `GetAllFactions` | Get all factions, sorted by order. |
| `GetFactionPlayerCount` | Check how many active players are in a faction. |
| `CanJoinFaction` | Check if a faction has room for another player. |
| `GetClassPlayerCount` | Check how many active players are in a class. |
| `CanJoinClass` | Check if a class has room for another player. |

### LoadoutManager (static)

Manages class-based loadout distribution. When a character is created or loaded, the loadout system checks their class for configured items and grants them.

```csharp
static void ApplyLoadout( HexPlayerComponent player, Characters.HexCharacter character )
```

| Member | Description |
|--------|-------------|
| `ApplyLoadout` | Apply the loadout for a character's class. Creates items and adds them to the character's main inventory. |

---

## Hexagon.Items

### ItemAction

Defines a context menu action for an item (like Helix's ITEM.functions).

```csharp
string Name { get; set; }
string Icon { get; set; }
Func<HexPlayerComponent, ItemInstance, bool> OnRun { get; set; }
Func<HexPlayerComponent, ItemInstance, bool> OnCanRun { get; set; }
```

| Member | Description |
|--------|-------------|
| `Name` | Display name of the action. |
| `Icon` | Icon name (material icon). |
| `OnRun` | Server-side callback when the action is executed. Return false to keep item, true to consume it. |
| `OnCanRun` | Permission check - should this action be visible/available? |

### ItemDefinition : GameResource

Base class for item type definitions. Create .item asset files in the s&box editor for simple items, or subclass in C# for items with custom behavior. Schema devs can create items visually (set name, model, size in editor) or extend this class for weapons, bags, outfits, etc.

```csharp
[Property] string UniqueId { get; set; }
[Property] string DisplayName { get; set; }
string Description { get; set; }
[Property] Model WorldModel { get; set; }
[Property] int Width { get; set; }
[Property] int Height { get; set; }
[Property] string Category { get; set; }
[Property] int MaxStack { get; set; }
[Property] bool CanDrop { get; set; }
[Property] int Order { get; set; }
virtual Dictionary<string, ItemAction> GetActions()
virtual bool OnUse( HexPlayerComponent player, ItemInstance item )
virtual bool OnCanUse( HexPlayerComponent player, ItemInstance item )
virtual void OnEquip( HexPlayerComponent player, ItemInstance item )
virtual void OnUnequip( HexPlayerComponent player, ItemInstance item )
virtual void OnDrop( HexPlayerComponent player, ItemInstance item )
virtual void OnPickup( HexPlayerComponent player, ItemInstance item )
virtual void OnTransferred( ItemInstance item, Inventory.HexInventory from, Inventory.HexInventory to )
virtual void OnInstanced( ItemInstance item )
virtual void OnRemoved( ItemInstance item )
```

| Member | Description |
|--------|-------------|
| `UniqueId` | Unique identifier for this item type. |
| `DisplayName` | Display name of the item. |
| `Description` | Description shown in tooltips. |
| `WorldModel` | World model for when the item is dropped on the ground. |
| `Width` | Inventory grid width (in cells). |
| `Height` | Inventory grid height (in cells). |
| `Category` | Category for organization (e.g. "Weapons", "Medical", "Misc"). |
| `MaxStack` | Maximum stack size. 1 = no stacking. |
| `CanDrop` | Whether this item can be dropped into the world. |
| `Order` | Sort order within category. |
| `GetActions` | Get the context menu actions for this item type. Override in subclasses to add Use, Equip, etc. |
| `OnUse` | Called when a player uses this item. Return true to consume (remove) the item. |
| `OnCanUse` | Permission check: can this player use this item? |
| `OnEquip` | Called when this item is equipped by a player. |
| `OnUnequip` | Called when this item is unequipped. |
| `OnDrop` | Called when this item is dropped into the world. |
| `OnPickup` | Called when this item is picked up from the world. |
| `OnTransferred` | Called when this item is transferred between inventories. |
| `OnInstanced` | Called when a new instance of this item is created. |
| `OnRemoved` | Called when an instance of this item is permanently removed. |

### ItemInstance

A runtime instance of an item, backed by the database. Each instance has a unique ID, references an ItemDefinition, and stores per-instance data (condition, ammo, custom data). Item instances live inside inventories at specific grid positions.

```csharp
string Id { get; set; }
string DefinitionId { get; set; }
string InventoryId { get; set; }
int X { get; set; }
int Y { get; set; }
Dictionary<string, object> Data { get; set; }
string CharacterId { get; set; }
bool IsDirty { get; set; }
ItemDefinition Definition
T GetData<T>( string key, T defaultValue )
void SetData( string key, object value )
void RemoveData( string key )
void MarkDirty()
void Save()
```

| Member | Description |
|--------|-------------|
| `Id` | Unique database ID for this item instance. |
| `DefinitionId` | The UniqueId of the ItemDefinition this instance is based on. |
| `InventoryId` | The inventory this item is currently in. 0 or empty = world/not in inventory. |
| `X` | Grid X position within the inventory. |
| `Y` | Grid Y position within the inventory. |
| `Data` | Per-instance custom data (condition, ammo count, custom properties, etc.). |
| `CharacterId` | The character ID that owns this item (for ownership tracking). |
| `IsDirty` | Whether this item instance has unsaved changes. |
| `Definition` | Get the ItemDefinition for this instance. |
| `GetData` | Get a per-instance data value. |
| `SetData` | Set a per-instance data value. Marks the item as dirty. |
| `RemoveData` | Remove a per-instance data value. |
| `MarkDirty` | Mark this item as having unsaved changes. |
| `Save` | Save this item instance to the database. |

### ItemManager (static)

Manages item definitions and active item instances. Definitions auto-register when .item GameResource assets load. Instances are created/loaded from the database.

```csharp
static IReadOnlyDictionary<string, ItemDefinition> Definitions
static IReadOnlyDictionary<string, ItemInstance> Instances
static void Register( ItemDefinition definition )
static ItemDefinition GetDefinition( string uniqueId )
static ItemInstance CreateInstance( string definitionId, string characterId, Dictionary<string, object> data )
static ItemInstance GetInstance( string instanceId )
static void DestroyInstance( string instanceId )
static void SaveAll()
static List<ItemInstance> LoadInstancesForCharacter( string characterId )
static List<ItemDefinition> GetDefinitionsByCategory( string category )
static List<string> GetCategories()
```

| Member | Description |
|--------|-------------|
| `Definitions` | All registered item definitions. |
| `Instances` | All active item instances. |
| `Register` | Register an item definition. Called automatically by ItemDefinition.PostLoad(). |
| `GetDefinition` | Get an item definition by its unique ID. |
| `CreateInstance` | Create a new item instance from a definition and persist it. |
| `GetInstance` | Get an active item instance by ID. |
| `DestroyInstance` | Remove an item instance permanently (from memory and database). |
| `SaveAll` | Save all dirty item instances to the database. |
| `LoadInstancesForCharacter` | Load all item instances for a specific character from the database. |
| `GetDefinitionsByCategory` | Get all definitions in a specific category. |
| `GetCategories` | Get all item categories. |

---

## Hexagon.Items.Bases

### AmmoItemDef : ItemDefinition

Base definition for ammo items. When used, loads ammo into a compatible weapon in the player's inventory, or adds to a reserve ammo pool.

```csharp
[Property] string AmmoType { get; set; }
[Property] int AmmoAmount { get; set; }
override Dictionary<string, ItemAction> GetActions()
override bool OnUse( HexPlayerComponent player, ItemInstance item )
```

| Member | Description |
|--------|-------------|
| `AmmoType` | The ammo type identifier. Must match WeaponItemDef.AmmoType to be compatible. |
| `AmmoAmount` | How much ammo this item gives when used. |
| `GetActions` |  |
| `OnUse` |  |

### BagItemDef : ItemDefinition

Base definition for bag/container items. When used, creates a nested inventory that the player can store additional items in.

```csharp
[Property] int BagWidth { get; set; }
[Property] int BagHeight { get; set; }
override Dictionary<string, ItemAction> GetActions()
void OpenBag( HexPlayerComponent player, ItemInstance item )
void CloseBag( HexPlayerComponent player, ItemInstance item )
override void OnRemoved( ItemInstance item )
```

| Member | Description |
|--------|-------------|
| `BagWidth` | Width of the bag's internal inventory grid. |
| `BagHeight` | Height of the bag's internal inventory grid. |
| `GetActions` |  |
| `OpenBag` | Open this bag for a player (adds them as a receiver of the bag's inventory). |
| `CloseBag` | Close this bag for a player. |
| `OnRemoved` |  |

### ConsumableItemDef : ItemDefinition

Base definition for consumable items (food, drinks, medical supplies, etc.). When used, runs a timed action (if UseTime > 0) then calls OnConsume for schema-defined effects. Return true from OnConsume to destroy the item, false to keep it.

```csharp
[Property] float UseTime { get; set; }
[Property] string UseSound { get; set; }
[Property] string ConsumeVerb { get; set; }
override Dictionary<string, ItemAction> GetActions()
override bool OnUse( HexPlayerComponent player, ItemInstance item )
virtual bool OnConsume( HexPlayerComponent player, ItemInstance item )
```

| Member | Description |
|--------|-------------|
| `UseTime` | Time in seconds to consume the item. 0 = instant consumption. If > 0, uses ActionBarManager.DoStaredAction with the ConsumeVerb text. |
| `UseSound` | Optional sound to play when consumption starts. |
| `ConsumeVerb` | Action bar text shown during timed consumption (e.g. "Eating...", "Drinking..."). |
| `GetActions` |  |
| `OnUse` |  |
| `OnConsume` | Called when consumption completes. Override in schema subclasses for custom effects (healing, buffs, etc.). Return true to destroy the item, false to keep it. |

### CurrencyItemDef : ItemDefinition

Base definition for physical currency items. When picked up or used, adds to the character's money. Supports split/merge for different denominations.

```csharp
[Property] int DefaultAmount { get; set; }
override Dictionary<string, ItemAction> GetActions()
int GetAmount( ItemInstance item )
void SetAmount( ItemInstance item, int amount )
override bool OnUse( HexPlayerComponent player, ItemInstance item )
override void OnInstanced( ItemInstance item )
static ItemInstance CreateWithAmount( string definitionId, int amount, string characterId )
```

| Member | Description |
|--------|-------------|
| `DefaultAmount` | Default value of a newly created currency item. The actual value is stored per-instance in Data["amount"]. |
| `GetActions` |  |
| `GetAmount` | Get the amount of money this currency item represents. |
| `SetAmount` | Set the amount of money this currency item represents. |
| `OnUse` |  |
| `OnInstanced` |  |
| `CreateWithAmount` | Create a currency item with a specific amount. |

### OutfitItemDef : ItemDefinition

Base definition for outfit/clothing items. When equipped, changes the player's model or bodygroups. Handles equip/unequip with model restoration.

```csharp
[Property] Model OutfitModel { get; set; }
[Property] Dictionary<string, int> Bodygroups { get; set; }
[Property] string Slot { get; set; }
override Dictionary<string, ItemAction> GetActions()
override void OnEquip( HexPlayerComponent player, ItemInstance item )
override void OnUnequip( HexPlayerComponent player, ItemInstance item )
```

| Member | Description |
|--------|-------------|
| `OutfitModel` | The model to apply when this outfit is equipped. If null, the player keeps their current model. |
| `Bodygroups` | Bodygroup overrides to apply when equipped. Key = bodygroup name, Value = choice index. |
| `Slot` | Equipment slot this outfit occupies (e.g. "head", "torso", "legs", "feet"). |
| `GetActions` |  |
| `OnEquip` |  |
| `OnUnequip` |  |

### WeaponItemDef : ItemDefinition

Base definition for weapon items. Handles equip/unequip lifecycle and ammo tracking. Schema devs can subclass this for specific weapon types or use it directly via .item assets.

```csharp
[Property] string AmmoType { get; set; }
[Property] int ClipSize { get; set; }
[Property] Model WeaponModel { get; set; }
[Property] bool TwoHanded { get; set; }
[Property] bool AlwaysRaised { get; set; }
[Property] bool FireWhenLowered { get; set; }
override Dictionary<string, ItemAction> GetActions()
int GetClipAmmo( ItemInstance item )
void SetClipAmmo( ItemInstance item, int amount )
override void OnInstanced( ItemInstance item )
```

| Member | Description |
|--------|-------------|
| `AmmoType` | The ammo definition ID this weapon uses. Empty for melee weapons. |
| `ClipSize` | Maximum ammo this weapon can hold in its magazine. |
| `WeaponModel` | Model used when the weapon is held (viewmodel or world attachment). |
| `TwoHanded` | Whether this weapon is two-handed (prevents offhand use). |
| `AlwaysRaised` | If true, this weapon skips raise/lower (e.g., toolgun, physgun). |
| `FireWhenLowered` | If true, this weapon can fire even when lowered (e.g., fists). |
| `GetActions` |  |
| `GetClipAmmo` | Get the current ammo in this weapon's clip. |
| `SetClipAmmo` | Set the current ammo in this weapon's clip. |
| `OnInstanced` |  |

---

## Hexagon.Inventory

### HexInventory

A grid-based inventory. Items occupy Width x Height cells at specific (X, Y) positions. Supports receiver-based networking - only players who should see this inventory receive its contents. Inventories are persisted to the database and restored when characters load.

```csharp
string Id { get; set; }
int Width { get; set; }
int Height { get; set; }
string OwnerId { get; set; }
string Type { get; set; }
List<string> ItemIds { get; set; }
bool CanItemFit( int x, int y, int w, int h, string excludeItemId )
bool AddAt( Items.ItemInstance item, int x, int y )
bool Add( Items.ItemInstance item )
bool Remove( string itemId )
bool Move( string itemId, int newX, int newY )
bool Transfer( string itemId, HexInventory target, int? targetX, int? targetY )
bool HasItem( string definitionId )
int CountItem( string definitionId )
bool IsFull
int ItemCount
void AddReceiver( Connection conn )
void RemoveReceiver( Connection conn )
IReadOnlySet<Connection> GetReceivers()
void Save()
```

| Member | Description |
|--------|-------------|
| `Id` | Unique database ID for this inventory. |
| `Width` | Grid width in cells. |
| `Height` | Grid height in cells. |
| `OwnerId` | The character ID that owns this inventory. Empty for world containers. |
| `Type` | Inventory type identifier (e.g. "main", "bag", "container"). |
| `ItemIds` | IDs of items in this inventory (for persistence). |
| `CanItemFit` | Check if an item of given size can fit at position (x, y). |
| `AddAt` | Add an item instance to this inventory at a specific position. Returns true if successful. |
| `Add` | Add an item instance to the first available slot. Returns true if successful. |
| `Remove` | Remove an item from this inventory. |
| `Move` | Move an item within this inventory to a new position. |
| `Transfer` | Transfer an item from this inventory to another. |
| `HasItem` | Check if this inventory has an item with the given definition ID. |
| `CountItem` | Count items with the given definition ID. |
| `IsFull` | Check if the inventory is full (no 1x1 slot available). |
| `ItemCount` | Number of items in the inventory. |
| `AddReceiver` | Add a player as a receiver of this inventory's contents. They will receive the full inventory state. |
| `RemoveReceiver` | Remove a player from this inventory's receivers. |
| `GetReceivers` | Get all current receivers. |
| `Save` | Save this inventory's metadata to the database. |

### InventorySnapshot

Snapshot of an inventory's state for client-side caching.

```csharp
string Id { get; set; }
string OwnerId { get; set; }
string Type { get; set; }
int Width { get; set; }
int Height { get; set; }
List<ItemSnapshot> Items { get; set; }
```

### ItemSnapshot

Snapshot of a single item instance within an inventory.

```csharp
string Id { get; set; }
string DefinitionId { get; set; }
int X { get; set; }
int Y { get; set; }
Dictionary<string, object> Data { get; set; }
```

### VendorCatalogEntry

Catalog entry sent to clients when opening a vendor.

```csharp
string DefinitionId { get; set; }
string DisplayName { get; set; }
string Description { get; set; }
string Category { get; set; }
int BuyPrice { get; set; }
int SellPrice { get; set; }
```

### HexInventoryComponent (sealed) : Component

Singleton network bridge for the inventory system. Lives on the HexagonFramework GameObject. Server-side: flushes dirty inventories to receivers via RPCs. Client-side: caches inventory snapshots for UI consumption. Also handles item action RPCs (move, transfer, drop, use) and vendor buy/sell RPCs.

```csharp
static HexInventoryComponent Instance { get; set; }
IReadOnlyDictionary<string, InventorySnapshot> ClientInventories
InventorySnapshot GetClientInventory( string id )
List<VendorCatalogEntry> CurrentVendorCatalog { get; set; }
string CurrentVendorId { get; set; }
string CurrentVendorName { get; set; }
void ReceiveInventorySnapshot( string json )
void ReceiveInventoryRemoved( string inventoryId )
void ReceiveVendorCatalog( string vendorId, string vendorName, string catalogJson )
void ReceiveVendorResult( bool success, string message )
[Rpc.Host] void RequestMoveItem( string inventoryId, string itemId, int newX, int newY )
[Rpc.Host] void RequestTransferItem( string sourceInvId, string itemId, string targetInvId, int x, int y )
[Rpc.Host] void RequestDropItem( string inventoryId, string itemId )
[Rpc.Host] void RequestUseItem( string inventoryId, string itemId )
[Rpc.Host] void RequestBuyItem( string vendorId, string definitionId )
[Rpc.Host] void RequestSellItem( string vendorId, string itemInstanceId )
```

| Member | Description |
|--------|-------------|
| `Instance` |  |
| `ClientInventories` | Client-side inventory cache, keyed by inventory ID. |
| `GetClientInventory` | Get a cached inventory snapshot by ID (client-side). |
| `CurrentVendorCatalog` | The most recently received vendor catalog (client-side). |
| `CurrentVendorId` | The vendor ID for the currently open vendor (client-side). |
| `CurrentVendorName` | The vendor name for the currently open vendor (client-side). |
| `ReceiveInventorySnapshot` | Server sends an inventory snapshot to filtered receivers. |
| `ReceiveInventoryRemoved` | Server notifies clients that an inventory is no longer available. |
| `ReceiveVendorCatalog` | Server sends a vendor catalog to the client. |
| `ReceiveVendorResult` | Server sends a vendor operation result to the client. |
| `RequestMoveItem` | Client requests to move an item within an inventory. |
| `RequestTransferItem` | Client requests to transfer an item between inventories. |
| `RequestDropItem` | Client requests to drop an item from an inventory into the world. |
| `RequestUseItem` | Client requests to use an item from an inventory. |
| `RequestBuyItem` | Client requests to buy an item from a vendor. |
| `RequestSellItem` | Client requests to sell an item to a vendor. |

### InventoryManager (static)

Manages inventory lifecycle: creation, restoration, persistence, and dirty tracking.

```csharp
static IReadOnlyDictionary<string, HexInventory> Inventories
static HexInventory Create( int width, int height, string ownerId, string type )
static HexInventory CreateDefault( string ownerId, string type )
static HexInventory Get( string inventoryId )
static List<HexInventory> LoadForCharacter( string characterId )
static void Delete( string inventoryId )
static void SaveAll()
static void Unload( string inventoryId )
```

| Member | Description |
|--------|-------------|
| `Inventories` | All active inventories. |
| `Create` | Create a new inventory and persist it. |
| `CreateDefault` | Create an inventory using the default config dimensions. |
| `Get` | Get an inventory by ID. Loads from database if not in memory. |
| `LoadForCharacter` | Load all inventories for a character. |
| `Delete` | Delete an inventory and all its items. |
| `SaveAll` | Save all dirty inventories and their items. |
| `Unload` | Unload an inventory from memory (e.g. when a character disconnects). Saves first. |

---

## Hexagon.Chat

### ICChat : IChatClass

Default in-character chat. No prefix. Range-limited. Format: {Name} says "{message}"

```csharp
string Name
string Prefix
float Range
Color Color
bool CanHear( HexPlayerComponent speaker, HexPlayerComponent listener )
bool CanSay( HexPlayerComponent speaker, string message )
string Format( HexPlayerComponent speaker, string message )
```

### YellChat : IChatClass

Yell chat. Prefix: /y. Extended range. Format: {Name} yells "{message}!"

```csharp
string Name
string Prefix
float Range
Color Color
bool CanHear( HexPlayerComponent speaker, HexPlayerComponent listener )
bool CanSay( HexPlayerComponent speaker, string message )
string Format( HexPlayerComponent speaker, string message )
```

### WhisperChat : IChatClass

Whisper chat. Prefix: /w. Short range. Format: {Name} whispers "{message}"

```csharp
string Name
string Prefix
float Range
Color Color
bool CanHear( HexPlayerComponent speaker, HexPlayerComponent listener )
bool CanSay( HexPlayerComponent speaker, string message )
string Format( HexPlayerComponent speaker, string message )
```

### MeChat : IChatClass

Action/emote chat. Prefix: /me. IC range. Format: ** {Name} {message} **

```csharp
string Name
string Prefix
float Range
Color Color
bool CanHear( HexPlayerComponent speaker, HexPlayerComponent listener )
bool CanSay( HexPlayerComponent speaker, string message )
string Format( HexPlayerComponent speaker, string message )
```

### ItChat : IChatClass

Impersonal action chat. Prefix: /it. IC range. Format: ** {message} **

```csharp
string Name
string Prefix
float Range
Color Color
bool CanHear( HexPlayerComponent speaker, HexPlayerComponent listener )
bool CanSay( HexPlayerComponent speaker, string message )
string Format( HexPlayerComponent speaker, string message )
```

### OOCChat : IChatClass

Out-of-character global chat. Prefix: /ooc (alias: //). Format: (OOC) {Name}: {message} Rate-limited by chat.oocDelay config.

```csharp
string Name
string Prefix
float Range
Color Color
bool CanHear( HexPlayerComponent speaker, HexPlayerComponent listener )
bool CanSay( HexPlayerComponent speaker, string message )
string Format( HexPlayerComponent speaker, string message )
```

### LOOCChat : IChatClass

Local out-of-character chat. Prefix: /looc (alias: .//). Format: (LOOC) {Name}: {message}

```csharp
string Name
string Prefix
float Range
Color Color
bool CanHear( HexPlayerComponent speaker, HexPlayerComponent listener )
bool CanSay( HexPlayerComponent speaker, string message )
string Format( HexPlayerComponent speaker, string message )
```

### RollChat : IChatClass

Dice roll chat. Prefix: /roll. IC range. Format: ** {Name} rolled {1-100} out of 100 ** The message text is ignored; a random roll is generated.

```csharp
string Name
string Prefix
float Range
Color Color
bool CanHear( HexPlayerComponent speaker, HexPlayerComponent listener )
bool CanSay( HexPlayerComponent speaker, string message )
string Format( HexPlayerComponent speaker, string message )
```

### PMChat : IChatClass

Private message chat. Prefix: /pm. Direct to a single player. First word after prefix is the target player name. Format: [PM from {Name}]: {message}

```csharp
string Name
string Prefix
float Range
Color Color
bool CanHear( HexPlayerComponent speaker, HexPlayerComponent listener )
bool CanSay( HexPlayerComponent speaker, string message )
string Format( HexPlayerComponent speaker, string message )
```

### EventChat : IChatClass

Event announcer chat. Prefix: /event. Global range. Requires admin flag. Format: ** {message} **

```csharp
string Name
string Prefix
float Range
Color Color
bool CanHear( HexPlayerComponent speaker, HexPlayerComponent listener )
bool CanSay( HexPlayerComponent speaker, string message )
string Format( HexPlayerComponent speaker, string message )
```

### ChatManager (static)

Central chat routing system. Registers chat classes, parses prefixes, routes messages to the correct chat class, and delegates to CommandManager for non-chat / prefixed input.

```csharp
static void Register( IChatClass chatClass )
static void RegisterAlias( string alias, string targetPrefix )
static IChatClass GetChatClass( string prefix )
static IChatClass GetDefaultChat()
static IReadOnlyDictionary<string, IChatClass> GetAllChatClasses()
static void ProcessMessage( HexPlayerComponent sender, string rawMessage )
static void SendSystemMessage( HexPlayerComponent target, string message )
static void SendDirectMessage( HexPlayerComponent sender, Connection target, IChatClass chatClass, string formatted )
```

| Member | Description |
|--------|-------------|
| `Register` | Register a chat class. If prefix is empty, it becomes the default IC chat. |
| `RegisterAlias` | Register an alias for a chat class prefix (e.g. "//" → "ooc"). |
| `GetChatClass` | Get a registered chat class by prefix. |
| `GetDefaultChat` | Get the default (no-prefix) chat class. |
| `GetAllChatClasses` | Get all registered chat classes. |
| `ProcessMessage` | Process a raw message from a player. Handles prefix parsing, chat class routing, and falls through to CommandManager for unrecognized / prefixed input. |
| `SendSystemMessage` | Send a system message to a specific player only. |
| `SendDirectMessage` | Send a formatted message to specific recipients with a given chat class appearance. Useful for PM and other targeted chat. |

### HexChatComponent (sealed) : Component

Network bridge for the chat system. Singleton component that lives on the HexagonFramework GameObject. Provides RPCs for sending and receiving chat messages. Color is passed as 3 floats (r, g, b) for RPC safety.

```csharp
static HexChatComponent Instance { get; set; }
[Rpc.Host] void SendMessage( string rawMessage )
void ReceiveMessage( string senderName, string chatClassName, string formattedMessage, float colorR, float colorG, float colorB )
```

| Member | Description |
|--------|-------------|
| `Instance` |  |
| `SendMessage` | Called by clients to send a raw chat message to the server. The server will parse, permission-check, and route it. |
| `ReceiveMessage` | Server-to-client broadcast of a formatted chat message. Only sent to filtered recipients via Rpc.FilterInclude. |

### IChatClass (interface)

Defines a chat class (IC, OOC, Yell, Whisper, etc.). Implement this interface and register with ChatManager to add custom chat types.

```csharp
string Name { get; }
string Prefix { get; }
float Range { get; }
Color Color { get; }
bool CanHear( HexPlayerComponent speaker, HexPlayerComponent listener )
bool CanSay( HexPlayerComponent speaker, string message )
string Format( HexPlayerComponent speaker, string message )
```

| Member | Description |
|--------|-------------|
| `Name` | Display name of this chat class (e.g. "In-Character", "OOC"). |
| `Prefix` | The prefix that triggers this chat class (e.g. "/y", "/w", "/me"). Empty string means this is the default chat class (no prefix needed). |
| `Range` | Maximum range in units. 0 = global (all players). |
| `Color` | The color of this chat class in the chat panel. |
| `CanHear` | Check if a listener can hear a message from this speaker. Called per-recipient after range filtering. |
| `CanSay` | Check if a speaker is allowed to send a message in this chat class. Return false to block (e.g. rate limits, permissions). |
| `Format` | Format the message for display (e.g. '{Name} says "{message}"'). |

---

## Hexagon.Commands

### CommandArg

Defines a single argument for a command.

```csharp
string Name { get; set; }
Type ArgType { get; set; }
bool IsOptional { get; set; }
bool IsRemainder { get; set; }
object DefaultValue { get; set; }
```

| Member | Description |
|--------|-------------|
| `Name` | Display name of the argument (e.g. "player", "amount"). |
| `ArgType` | Expected type: typeof(HexPlayerComponent), typeof(string), typeof(int), typeof(float). |
| `IsOptional` | Whether this argument can be omitted. |
| `IsRemainder` | If true, this argument captures all remaining tokens as a single string. Must be the last argument. |
| `DefaultValue` | Default value if the argument is optional and not provided. |

### Arg (static)

Factory methods for creating command arguments.

```csharp
static CommandArg Player( string name )
static CommandArg String( string name, bool remainder )
static CommandArg Number( string name )
static CommandArg Int( string name )
static CommandArg Optional( CommandArg arg, object defaultValue )
```

| Member | Description |
|--------|-------------|
| `Player` |  |
| `String` |  |
| `Number` |  |
| `Int` |  |
| `Optional` | Make an existing argument optional with a default value. |

### CommandContext

Contains parsed arguments for a command execution.

```csharp
string RawInput { get; set; }
T Get<T>( string name, T defaultValue )
void Set( string name, object value )
bool Has( string name )
```

| Member | Description |
|--------|-------------|
| `RawInput` | The raw input string (everything after the command name). |
| `Get` | Get a parsed argument by name. |
| `Set` | Set a parsed argument value. |
| `Has` | Check if an argument was provided. |

### CommandManager (static)

Manages command registration, parsing, permission checking, and execution. Commands are invoked when a player types /{name} in chat and it doesn't match a chat class prefix.

```csharp
static void Register( HexCommand command )
static HexCommand GetCommand( string name )
static IReadOnlyDictionary<string, HexCommand> GetAllCommands()
static string Execute( HexPlayerComponent caller, string name, string rawArgs )
```

| Member | Description |
|--------|-------------|
| `Register` | Register a command. |
| `GetCommand` | Get a command by name or alias. |
| `GetAllCommands` | Get all registered commands. |
| `Execute` | Execute a command by name with raw argument input. Returns a message to send to the caller. Called by ChatManager when a /prefixed message doesn't match a chat class. |

### HexCommand

Defines a chat command. Register with CommandManager.Register().

```csharp
string Name { get; set; }
string Description { get; set; }
string[] Aliases { get; set; }
string Permission { get; set; }
Func<HexPlayerComponent, bool> PermissionFunc { get; set; }
CommandArg[] Arguments { get; set; }
Func<HexPlayerComponent, CommandContext, string> OnRun { get; set; }
```

| Member | Description |
|--------|-------------|
| `Name` | Primary command name (without prefix). E.g. "givemoney". |
| `Description` | Description shown in help text. |
| `Aliases` | Alternative names for this command. |
| `Permission` | Required permission flag string (e.g. "a" for admin, "s" for super admin). Empty = no permission required. |
| `PermissionFunc` | Custom permission check function. If set, called in addition to flag check. |
| `Arguments` | Argument definitions for this command. |
| `OnRun` | Handler called when the command is executed. Parameters: (caller, context). Return a string message to send back to the caller. |

---

## Hexagon.Permissions

### FlagInfo

Info about a registered permission flag.

```csharp
char Flag { get; set; }
string Description { get; set; }
```

### PermissionManager (static)

Manages permission flags and provides permission checks. Flags are single characters assigned to characters (e.g. 'a' = Admin, 's' = Super Admin). The 's' flag bypasses all permission checks.

```csharp
static void RegisterFlag( char flag, string description )
static FlagInfo GetFlagInfo( char flag )
static IReadOnlyDictionary<char, FlagInfo> GetAllFlags()
static bool HasPermission( HexPlayerComponent player, string requirement )
```

| Member | Description |
|--------|-------------|
| `RegisterFlag` | Register a permission flag with a description. |
| `GetFlagInfo` | Get info about a registered flag. |
| `GetAllFlags` | Get all registered flags. |
| `HasPermission` | Check if a player has permission for a given requirement. If requirement is 1-2 characters and all are registered flags, checks character flags directly. Otherwise fires IPermissionCheckListener for schema-defined permissions. The 's' (Super Admin) flag bypasses all checks. |

---

## Hexagon.Currency

### CurrencyManager (static)

Manages character currency. Uses the "Money" CharVar on HexCharacterData for storage, which triggers existing dirty tracking and networking automatically.

```csharp
static string Format( int amount )
static int GetMoney( HexCharacter character )
static void GiveMoney( HexCharacter character, int amount, string reason )
static bool TakeMoney( HexCharacter character, int amount, string reason )
static void SetMoney( HexCharacter character, int amount, string reason )
static bool CanAfford( HexCharacter character, int amount )
```

| Member | Description |
|--------|-------------|
| `Format` | Format a money amount with the configured currency symbol (e.g. "$500"). |
| `GetMoney` | Get a character's current money. |
| `GiveMoney` | Give money to a character. Amount must be positive. |
| `TakeMoney` | Take money from a character. Returns false if they can't afford it. |
| `SetMoney` | Set a character's money to an exact amount. |
| `CanAfford` | Check if a character can afford a given amount. |

---

## Hexagon.Attributes

### AttributeBoost

A temporary or permanent modifier to a character's attribute. Boosts stack additively and are evaluated at runtime.

```csharp
string Id { get; set; }
string AttributeId { get; set; }
float Amount { get; set; }
DateTime? ExpiresAt { get; set; }
bool IsExpired
```

| Member | Description |
|--------|-------------|
| `Id` | Unique identifier for this boost (for removal). |
| `AttributeId` | Which attribute this boost modifies (matches AttributeDefinition.UniqueId). |
| `Amount` | Flat amount to add (can be negative for debuffs). |
| `ExpiresAt` | When this boost expires. Null = permanent. |
| `IsExpired` | Whether this boost has expired. |

### AttributeDefinition : GameResource

Defines an attribute type (e.g. Hunger, Stamina, Health). Create .attrib asset files in the s&box editor to define attribute types. Auto-registers with AttributeManager when the asset loads.

```csharp
[Property] string UniqueId { get; set; }
[Property] string DisplayName { get; set; }
[Property] float MinValue { get; set; }
[Property] float MaxValue { get; set; }
[Property] float StartValue { get; set; }
```

| Member | Description |
|--------|-------------|
| `UniqueId` | Unique identifier for this attribute (e.g. "hunger", "stamina"). |
| `DisplayName` | Display name shown in UI. |
| `MinValue` | Minimum value this attribute can reach. |
| `MaxValue` | Maximum value this attribute can reach. |
| `StartValue` | Starting value for new characters. |

### AttributeManager (static)

Manages attribute definitions and per-character attribute values + boosts. Base values stored in character data as "hex_attr_{id}". Boosts stored as "hex_boosts" JSON list.

```csharp
static void RegisterDefinition( AttributeDefinition definition )
static AttributeDefinition GetDefinition( string id )
static IReadOnlyDictionary<string, AttributeDefinition> GetAllDefinitions()
static float GetAttribute( HexCharacter character, string attributeId )
static float GetBaseAttribute( HexCharacter character, string attributeId )
static void SetAttribute( HexCharacter character, string attributeId, float value )
static void AddAttribute( HexCharacter character, string attributeId, float amount )
static void AddBoost( HexCharacter character, string attributeId, float amount, TimeSpan? duration, string boostId )
static bool RemoveBoost( HexCharacter character, string boostId )
static void ClearBoosts( HexCharacter character, string attributeId )
static List<AttributeBoost> GetBoosts( HexCharacter character )
static void InitializeCharacter( HexCharacter character )
```

| Member | Description |
|--------|-------------|
| `RegisterDefinition` | Register an attribute definition (called by AttributeDefinition.PostLoad). |
| `GetDefinition` | Get an attribute definition by ID. |
| `GetAllDefinitions` | Get all registered attribute definitions. |
| `GetAttribute` | Get the effective attribute value for a character (base + boosts, clamped). |
| `GetBaseAttribute` | Get the base attribute value (without boosts). |
| `SetAttribute` | Set the base attribute value. Fires IAttributeChangedListener. |
| `AddAttribute` | Add to the base attribute value. |
| `AddBoost` | Add a boost to a character's attribute. |
| `RemoveBoost` | Remove a specific boost by ID. |
| `ClearBoosts` | Remove all boosts for a specific attribute. |
| `GetBoosts` | Get all active (non-expired) boosts for a character. |
| `InitializeCharacter` | Initialize all registered attributes on a character with their start values. Call this when a character is first created. |

---

## Hexagon.Config

### HexConfig (static)

Server-side configuration system. Admin-controlled settings that are persisted and synced to all connected clients. Usage: HexConfig.Add("walkSpeed", 200f, "Default walk speed"); HexConfig.Add("maxCharacters", 5, "Max characters per player"); var speed = HexConfig.Get&lt;float&gt;("walkSpeed"); HexConfig.Set("walkSpeed", 150f);

```csharp
static IReadOnlyDictionary<string, ConfigEntry> Entries
static void Add( string key, object defaultValue, string description, string category, Action<object, object> onChange )
static T Get<T>( string key, T fallback )
static void Set( string key, object value )
static void Reset( string key )
static void Save()
static void Load()
```

| Member | Description |
|--------|-------------|
| `Entries` | All registered config entries. |
| `Add` | Register a new config entry with a default value. Call this during plugin/schema initialization. |
| `Get` | Get a config value. Returns the override if set, otherwise the default. |
| `Set` | Set a config value (creates an override). Triggers OnChange callback if registered. |
| `Reset` | Reset a config value back to its default. |
| `Save` | Save all config overrides to disk. |
| `Load` | Load config overrides from disk. |

### ConfigEntry

A registered configuration entry.

```csharp
string Key { get; set; }
object DefaultValue { get; set; }
string Description { get; set; }
string Category { get; set; }
Type ValueType { get; set; }
Action<object, object> OnChange { get; set; }
```

---

## Hexagon.Logging

### LogType (enum)

Types of log entries for categorization and filtering.

### LogEntry

A single log entry recording a player action or system event.

```csharp
DateTime Timestamp { get; set; }
LogType Type { get; set; }
ulong SteamId { get; set; }
string PlayerName { get; set; }
string Message { get; set; }
```

### HexLog (static)

Server-side logging system for tracking player actions and system events. Logs are date-partitioned into separate database collections for efficient querying. Storage: hexagon/logs_YYYY-MM-DD/{guid}.json

```csharp
static void Add( LogType type, HexPlayerComponent player, string message )
static void Add( LogType type, string message )
static List<LogEntry> GetLogs( DateTime date )
static List<LogEntry> GetLogs( DateTime date, LogType type )
static List<LogEntry> GetLogsForPlayer( DateTime date, ulong steamId )
```

| Member | Description |
|--------|-------------|
| `Add` | Record a log entry for a player action. |
| `Add` | Record a system log entry with no associated player. |
| `GetLogs` | Get all log entries for a specific date. |
| `GetLogs` | Get all log entries for a specific date and type. |
| `GetLogsForPlayer` | Get all log entries for a specific date and player. |

---

## Hexagon.Doors

### DoorComponent (sealed) : Component, Component.IPressable, Component.IDamageable

A world-placed door that supports ownership, locking, access control, and breach mechanics. Interacted with via the USE key (IPressable). Locks can be damaged via IDamageable (shootlock) or the TryKick() API. Place on any GameObject in the scene. Set DoorId in the editor or let it auto-generate. Schema devs bind IsOpen to their door animation system. Authorization hierarchy: admin flag ("a") > character owner > faction member > access list

```csharp
[Property] string DoorId { get; set; }
[Property] string DoorName { get; set; }
[Sync] bool IsLocked { get; set; }
[Sync] bool IsOpen { get; set; }
[Sync] string OwnerDisplay { get; set; }
[Sync] int LockHealth { get; set; }
int MaxLockHealth { get; set; }
DoorData Data
bool CanPress( Component.IPressable.Event e )
bool Press( Component.IPressable.Event e )
void OnDamage( in DamageInfo damage )
void ToggleOpen()
void SetLocked( bool locked )
void TryKick( HexPlayerComponent player )
void RepairLock()
bool IsAuthorized( HexPlayerComponent player )
void SetOwnerCharacter( string characterId, string displayName )
bool SetOwnerFaction( string factionId )
void ClearOwner()
void AddAccess( string characterId )
void RemoveAccess( string characterId )
```

| Member | Description |
|--------|-------------|
| `DoorId` | Unique identifier for this door. Auto-generated if empty on enable. |
| `DoorName` | Display name shown in the tooltip. |
| `IsLocked` | Whether the door is currently locked. Synced to all players. |
| `IsOpen` | Whether the door is currently open. Schema binds this to door animation. |
| `OwnerDisplay` | Display name of the current owner. Synced to all players for tooltip display. |
| `LockHealth` | Current lock health. When reduced to 0, the lock is breached. |
| `MaxLockHealth` | Maximum lock health for this door. |
| `Data` | The underlying door data. Loaded from the database on enable. |
| `CanPress` |  |
| `Press` |  |
| `OnDamage` | Called when the door takes damage (e.g. from gunfire). Damages the lock if applicable. |
| `ToggleOpen` | Toggle the door between open and closed. |
| `SetLocked` | Set the door's locked state. |
| `TryKick` | Attempt to kick the door. Uses ActionBarManager for a timed action. Schema decides how to trigger this (keybind, alt-use, command, etc.). |
| `RepairLock` | Repair the lock to full health and re-lock the door. Schema decides when to call this (admin command, timed auto-repair, map reset, etc.). |
| `IsAuthorized` | Check if a player is authorized to use this door when locked. Hierarchy: admin flag > character owner > faction member > access list |
| `SetOwnerCharacter` | Set a character as the owner. Clears faction ownership and access list. |
| `SetOwnerFaction` | Set a faction as the owner. Clears character ownership and access list. Returns false if faction ownership is disabled by config. |
| `ClearOwner` | Remove all ownership and unlock the door. |
| `AddAccess` | Add a character to the access list. |
| `RemoveAccess` | Remove a character from the access list. |

### DoorData

Serializable door state persisted to the database. A door can be owned by a character OR a faction, but not both.

```csharp
string DoorId { get; set; }
string OwnerCharacterId { get; set; }
string OwnerFactionId { get; set; }
bool IsLocked { get; set; }
List<string> AccessList { get; set; }
int LockHealth { get; set; }
int MaxLockHealth { get; set; }
bool HasOwner
```

| Member | Description |
|--------|-------------|
| `DoorId` | Unique identifier for this door. Matches the DoorComponent's DoorId property. |
| `OwnerCharacterId` | Character ID of the owner. Mutually exclusive with OwnerFactionId. |
| `OwnerFactionId` | Faction ID of the owner. Mutually exclusive with OwnerCharacterId. |
| `IsLocked` | Whether the door is currently locked. |
| `AccessList` | Additional character IDs that have access to this door. |
| `LockHealth` | Current lock health. -1 = use config default; 0 = broken. |
| `MaxLockHealth` | Maximum lock health. -1 = use config default. |
| `HasOwner` | Whether this door has any owner. |

### DoorManager (static)

Manages door registration, persistence, and lookup. DoorComponents register/unregister themselves on enable/disable.

```csharp
static DoorComponent GetDoor( string doorId )
static IReadOnlyDictionary<string, DoorComponent> GetAllDoors()
static void SaveDoor( DoorData data )
static DoorData LoadDoor( string doorId )
static void DeleteDoor( string doorId )
static void SaveAll()
```

| Member | Description |
|--------|-------------|
| `GetDoor` | Get a door component by its ID. |
| `GetAllDoors` | Get all registered doors. |
| `SaveDoor` | Save door data to the database. |
| `LoadDoor` | Load door data from the database. |
| `DeleteDoor` | Delete door data from the database. |
| `SaveAll` | Save all registered doors to the database. |

---

## Hexagon.Storage

### StorageComponent (sealed) : Component, Component.IPressable

A world-placed storage container that players can interact with via USE key. Items persist across server restarts via the inventory system. Place on any GameObject in the scene. The InventoryId is generated on first use and persists via scene save, linking to the database-backed inventory.

```csharp
[Property] string StorageName { get; set; }
[Property] int Width { get; set; }
[Property] int Height { get; set; }
[Property] string InventoryId { get; set; }
HexInventory Inventory
bool CanPress( Component.IPressable.Event e )
bool Press( Component.IPressable.Event e )
void Release( Component.IPressable.Event e )
void Blur( Component.IPressable.Event e )
```

| Member | Description |
|--------|-------------|
| `StorageName` | Display name shown in the tooltip. |
| `Width` | Grid width of the storage inventory. |
| `Height` | Grid height of the storage inventory. |
| `InventoryId` | Persisted inventory ID. Set automatically on first interaction. |
| `Inventory` | The backing inventory for this container. |
| `CanPress` |  |
| `Press` |  |
| `Release` |  |
| `Blur` |  |

---

## Hexagon.Vendors

### VendorComponent (sealed) : Component, Component.IPressable

A world-placed vendor NPC that players can interact with to buy and sell items. Interacted with via the USE key (IPressable). Place on any GameObject in the scene. Set VendorId in the editor or let it auto-generate. Configure the catalog via admin commands or the public API.

```csharp
[Property] string VendorId { get; set; }
[Property] string VendorName { get; set; }
VendorData Data
bool CanPress( Component.IPressable.Event e )
bool Press( Component.IPressable.Event e )
void AddItem( string definitionId, int buyPrice, int sellPrice )
bool RemoveItem( string definitionId )
List<VendorItem> GetItems()
VendorItem GetVendorItem( string definitionId )
```

| Member | Description |
|--------|-------------|
| `VendorId` | Unique identifier for this vendor. Auto-generated if empty on enable. |
| `VendorName` | Display name shown in the tooltip and UI. |
| `Data` | The underlying vendor data loaded from the database. |
| `CanPress` |  |
| `Press` |  |
| `AddItem` | Add or update an item in the vendor's catalog. |
| `RemoveItem` | Remove an item from the vendor's catalog. |
| `GetItems` | Get all items in the vendor's catalog. |
| `GetVendorItem` | Get a specific vendor item by definition ID. |

### VendorItem

A single item entry in a vendor's catalog with buy/sell prices.

```csharp
string DefinitionId { get; set; }
int BuyPrice { get; set; }
int SellPrice { get; set; }
```

| Member | Description |
|--------|-------------|
| `DefinitionId` | The ItemDefinition unique ID for this vendor listing. |
| `BuyPrice` | Price a player pays to buy this item. 0 = not for sale. |
| `SellPrice` | Price a player receives when selling this item. 0 = cannot sell. |

### VendorData

Serializable vendor catalog persisted to the database.

```csharp
string VendorId { get; set; }
string VendorName { get; set; }
List<VendorItem> Items { get; set; }
```

| Member | Description |
|--------|-------------|
| `VendorId` | Unique identifier for this vendor. Matches the VendorComponent's VendorId. |
| `VendorName` | Display name of the vendor. |
| `Items` | The items this vendor buys and sells. |

### VendorManager (static)

Manages vendor registration, persistence, and buy/sell operations. VendorComponents register/unregister themselves on enable/disable.

```csharp
static VendorComponent GetVendor( string vendorId )
static IReadOnlyDictionary<string, VendorComponent> GetAllVendors()
static void SaveVendor( VendorData data )
static VendorData LoadVendor( string vendorId )
```

| Member | Description |
|--------|-------------|
| `GetVendor` | Get a vendor component by its ID. |
| `GetAllVendors` | Get all registered vendors. |
| `SaveVendor` | Save vendor data to the database. |
| `LoadVendor` | Load vendor data from the database. |

---

## Hexagon.UI

### UIState (enum)

UI state machine states.

### HexUIManager (sealed) : Component, ICharacterLoadedListener, ICharacterUnloadedListener

Central UI coordinator. Manages panel visibility, input dispatch, cursor state, and the UI state machine. Lives on the ScreenPanel GameObject. Schema devs can replace individual panels by disabling the defaults and adding their own IHexPanel implementations. HexUIManager discovers panels via Scene.GetAll&lt;IHexPanel&gt;().

```csharp
static HexUIManager Instance { get; set; }
UIState State { get; set; }
void SetState( UIState newState )
IHexPanel FindPanel( string name )
void OpenPanel( string name )
void ClosePanel( string name )
void TogglePanel( string name )
void CloseTopmostPanel()
void OnCharacterLoaded( HexPlayerComponent player, HexCharacter character )
void OnCharacterUnloaded( HexPlayerComponent player, HexCharacter character )
static HexPlayerComponent GetLocalPlayer()
```

| Member | Description |
|--------|-------------|
| `Instance` |  |
| `State` | Current UI state. |
| `SetState` | Transition to a new UI state. Hides/shows panels appropriate to that state. |
| `FindPanel` | Find a panel by name. |
| `OpenPanel` | Open a panel by name. |
| `ClosePanel` | Close a panel by name. |
| `TogglePanel` | Toggle a panel open/closed by name. |
| `CloseTopmostPanel` | Close the topmost open overlay panel. |
| `OnCharacterLoaded` |  |
| `OnCharacterUnloaded` |  |
| `GetLocalPlayer` | Get the local player's HexPlayerComponent. |

### HexUISetup (static)

Static helper that auto-creates the full Hexagon UI hierarchy if not already present. Creates a ScreenPanel root with HexUIManager and all 9 default panels.

```csharp
static void EnsureUI( Scene scene )
```

| Member | Description |
|--------|-------------|
| `EnsureUI` | Ensure HexUIManager and all default panels exist in the scene. If a HexUIManager is already present, this is a no-op. |

### IHexPanel (interface)

Interface for all Hexagon UI panels. Implement on PanelComponents to allow HexUIManager to discover and coordinate them. Schema devs can replace default panels by disabling the built-in ones and adding their own IHexPanel implementations.

```csharp
string PanelName { get; }
bool IsOpen { get; }
void Open()
void Close()
```

| Member | Description |
|--------|-------------|
| `PanelName` | Unique name for this panel (e.g. "CharacterSelect", "Inventory"). |
| `IsOpen` | Whether this panel is currently visible. |
| `Open` | Show the panel. |
| `Close` | Hide the panel. |

### NotificationManager (static)

Server-side notification system. Sends toast notifications to specific players. Use this for transient feedback (command results, errors) instead of chat messages.

```csharp
static void Send( HexPlayerComponent target, string message )
static void Send( HexPlayerComponent target, string message, float duration )
static void SendAll( string message )
static void SendAll( string message, float duration )
```

| Member | Description |
|--------|-------------|
| `Send` | Send a notification to a specific player with the default duration. |
| `Send` | Send a notification to a specific player with a custom duration in seconds. |
| `SendAll` | Send a notification to all connected players with the default duration. |
| `SendAll` | Send a notification to all connected players with a custom duration. |

---

## Hexagon.Persistence

### DatabaseManager (static)

JSON-based persistence layer using s&box's FileSystem.Data. Documents are organized into collections (directories) and identified by string keys. All data is cached in memory for fast reads, with writes going to disk. Structure on disk: hexagon/{collection}/{key}.json

```csharp
static void Save<T>( string collection, string key, T document )
static T Load<T>( string collection, string key )
static void Delete( string collection, string key )
static bool Exists( string collection, string key )
static List<T> LoadAll<T>( string collection )
static List<T> Select<T>( string collection, Func<T, bool> predicate )
static List<string> GetKeys( string collection )
static string NewId()
```

| Member | Description |
|--------|-------------|
| `Save` | Save a document to a collection. Serializes to JSON and writes to disk. |
| `Load` | Load a document from a collection. Checks cache first, then disk. Returns default(T) if not found. |
| `Delete` | Delete a document from a collection. |
| `Exists` | Check if a document exists in a collection. |
| `LoadAll` | Load all documents from a collection. Scans the collection directory for JSON files. |
| `Select` | Load all documents from a collection that match a predicate. |
| `GetKeys` | Get all document keys in a collection. |
| `NewId` | Generate a unique ID for a new document. |

---

## Listener Interfaces

All listener interfaces for the Hexagon event system. Implement on a Component for auto-discovery via `Scene.GetAll<T>()`.

### Framework Lifecycle

```csharp
// Called when the Hexagon framework has finished initializing all systems.
interface IFrameworkInitListener
{
    void OnFrameworkInit();
}

// Called when the Hexagon framework is shutting down.
interface IFrameworkShutdownListener
{
    void OnFrameworkShutdown();
}

```

### Characters & Players

```csharp
// Called when a player has fully connected and their GameObject is spawned.
interface IPlayerConnectedListener
{
    void OnPlayerConnected( HexPlayerComponent player, Connection connection );
}

// Called when a player disconnects.
interface IPlayerDisconnectedListener
{
    void OnPlayerDisconnected( HexPlayerComponent player, Connection connection );
}

// Override spawn positions for connecting players.
interface IPlayerSpawnListener
{
    Vector3 GetSpawnPosition( Connection connection, Vector3 currentPosition );
}

// Called when a character is loaded for a player.
interface ICharacterLoadedListener
{
    void OnCharacterLoaded( HexPlayerComponent player, HexCharacter character );
}

// Called when a character is unloaded (player switches or disconnects).
interface ICharacterUnloadedListener
{
    void OnCharacterUnloaded( HexPlayerComponent player, HexCharacter character );
}

// Permission hook: can a player create a character? Return false to block.
interface ICanCharacterCreate
{
    bool CanCharacterCreate( HexPlayerComponent player, HexCharacterData data );
}

// Called after a new character is created.
interface ICharacterCreatedListener
{
    void OnCharacterCreated( HexPlayerComponent player, HexCharacter character );
}

// Permission hook: can a character be recognized? Return false to block (e.g., disguise system).
interface ICanRecognizeListener
{
    bool CanRecognize( HexCharacter observer, HexCharacter target );
}

// Fired after a character is recognized by another through introduction.
interface ICharacterRecognizedListener
{
    void OnCharacterRecognized( HexPlayerComponent introducer, HexPlayerComponent recognizer );
}

```

### Chat

```csharp
// Permission hook: can a player send a chat message? Return false to block.
interface ICanSendChatMessage
{
    bool CanSendChatMessage( HexPlayerComponent sender, IChatClass chatClass, string message );
}

// Server-side: fired after a chat message is sent.
interface IChatMessageListener
{
    void OnChatMessage( HexPlayerComponent sender, IChatClass chatClass, string rawMessage, string formattedMessage );
}

// Client-side: fired when a chat message is received.
interface IChatMessageReceivedListener
{
    void OnChatMessageReceived( string senderName, string chatClassName, string formattedMessage, Color color );
}

```

### Commands

```csharp
// Permission hook: can a player run a command? Return false to block.
interface ICanRunCommandListener
{
    bool CanRunCommand( HexPlayerComponent player, HexCommand command );
}

```

### Permissions

```csharp
// Hook for schema-defined permission checks beyond simple flags. Return false to deny the permission.
interface IPermissionCheckListener
{
    bool OnPermissionCheck( HexPlayerComponent player, string permission );
}

```

### Currency

```csharp
// Permission hook: can a money change occur? Return false to block.
interface ICanMoneyChangeListener
{
    bool CanMoneyChange( HexCharacter character, int oldAmount, int newAmount, string reason );
}

// Fired after a money change has occurred.
interface IMoneyChangedListener
{
    void OnMoneyChanged( HexCharacter character, int oldAmount, int newAmount, string reason );
}

```

### Attributes

```csharp
// Fired when a character's effective attribute value changes (base or boost change).
interface IAttributeChangedListener
{
    void OnAttributeChanged( HexCharacter character, string attributeId, float oldValue, float newValue );
}

```

### Doors

```csharp
// Permission hook: can a player use this door? Return false to block.
interface ICanUseDoorListener
{
    bool CanUseDoor( HexPlayerComponent player, DoorComponent door );
}

// Fired after a player uses a door (toggle, lock/unlock).
interface IDoorUsedListener
{
    void OnDoorUsed( HexPlayerComponent player, DoorComponent door );
}

// Fired when door ownership changes.
interface IDoorOwnerChangedListener
{
    void OnDoorOwnerChanged( DoorComponent door, string oldOwnerId, string newOwnerId, bool isFaction );
}

// Fired when a door's lock takes damage from shooting or kicking.
interface IDoorDamagedListener
{
    void OnDoorDamaged( HexPlayerComponent attacker, DoorComponent door, float damage, int remainingHealth ); // Called when a door's lock is damaged.
}

// Fired when a door's lock is destroyed and the door is breached open.
interface IDoorBreachedListener
{
    void OnDoorBreached( HexPlayerComponent attacker, DoorComponent door ); // Called when a door's lock breaks and the door swings open.
}

// Permission hook: can a player kick this door? Return false to block.
interface ICanKickDoorListener
{
    bool CanKickDoor( HexPlayerComponent player, DoorComponent door ); // Called before a player attempts to kick a door.
}

```

### Storage

```csharp
// Permission hook: can a player open this storage container? Return false to block.
interface ICanOpenStorageListener
{
    bool CanOpenStorage( HexPlayerComponent player, StorageComponent storage );
}

// Fired when a player opens a storage container.
interface IStorageOpenedListener
{
    void OnStorageOpened( HexPlayerComponent player, StorageComponent storage );
}

// Fired when a player closes a storage container (release or look away).
interface IStorageClosedListener
{
    void OnStorageClosed( HexPlayerComponent player, StorageComponent storage );
}

```

### Vendors

```csharp
// Permission hook: can a player buy this item? Return false to block.
interface ICanBuyItemListener
{
    bool CanBuyItem( HexPlayerComponent player, VendorComponent vendor, VendorItem item );
}

// Permission hook: can a player sell this item? Return false to block.
interface ICanSellItemListener
{
    bool CanSellItem( HexPlayerComponent player, VendorComponent vendor, VendorItem item, ItemInstance instance );
}

// Fired after a player buys an item from a vendor.
interface IItemBoughtListener
{
    void OnItemBought( HexPlayerComponent player, VendorComponent vendor, VendorItem item, ItemInstance instance );
}

// Fired after a player sells an item to a vendor.
interface IItemSoldListener
{
    void OnItemSold( HexPlayerComponent player, VendorComponent vendor, VendorItem item );
}

// Fired when a player opens/interacts with a vendor.
interface IVendorOpenedListener
{
    void OnVendorOpened( HexPlayerComponent player, VendorComponent vendor );
}

```

### Inventory

```csharp
// Client-side: fired when an inventory snapshot is received or updated.
interface IInventoryUpdatedListener
{
    void OnInventoryUpdated( string inventoryId );
}

// Client-side: fired when an inventory is no longer available (e.g. closed storage).
interface IInventoryRemovedListener
{
    void OnInventoryRemoved( string inventoryId );
}

// Client-side: fired when a vendor catalog is received.
interface IVendorCatalogReceivedListener
{
    void OnVendorCatalogReceived( string vendorId, string vendorName, List<VendorCatalogEntry> items );
}

// Client-side: fired when a vendor buy/sell result is received.
interface IVendorResultListener
{
    void OnVendorResult( bool success, string message );
}

```

### UI

```csharp
// Client-side: fired when the chat input should be focused (ENTER pressed).
interface IChatFocusRequestListener
{
    void OnChatFocusRequested();
}

// Fired when the death screen respawn button is pressed. Schema devs implement this to handle respawn logic.
interface IDeathScreenRespawnListener
{
    void OnRespawnRequested( HexPlayerComponent player );
}

// Client-side: fired when a notification toast is received.
interface INotificationReceivedListener
{
    void OnNotificationReceived( string message, float duration ); // Called on the client when a toast notification arrives.
}

```

### Logging

```csharp
// Listener interface for receiving log entries in real-time.
interface ILogListener
{
    void OnLog( LogEntry entry );
}

```

